syntax = "proto3";

package sentiric.sip.v1;

option go_package = "github.com/sentiric/sentiric-contracts/gen/go/sentiric/sip/v1;sipv1";

// ProxyService, SBC ve diğer sinyalleşme birimlerinin yönlendirme kararı 
// alması için kullanılan merkezi otoritedir.
service ProxyService {
  // GetNextHop: Verilen hedefe giden yolun (Next-Hop) bilgisini döndürür.
  rpc GetNextHop(GetNextHopRequest) returns (GetNextHopResponse);
}

message GetNextHopRequest {
  // destination_uri: Aranan hedef (örn: sip:9999@sentiric.cloud)
  string destination_uri = 1; 

  // source_ip: Paketin SBC'ye ulaştığı fiziksel IP adresi (Rate-limit için).
  string source_ip = 2;       
  
  // method: SIP Metodu (örn: INVITE, REGISTER).
  string method = 3; 

  // from_uri: Arayan kişinin kimlik bilgisi (örn: <sip:+905548777858@34.122.40.122>)
  // [NEW v1.15.0]: Dialplan katmanında kimlik tanıma için eklenmiştir.
  string from_uri = 4;
}

message GetNextHopResponse {
  // uri: Hedefin SIP adresi (örn: 100.67.38.96:13084)
  string uri = 1; 
  
  // gateway_id: İşlemi yürüten ağ geçidinin mantıksal adı.
  string gateway_id = 2;
}
// File: proto/sentiric/stt/v1/whisper.proto
syntax = "proto3";

package sentiric.stt.v1;

option go_package = "github.com/sentiric/sentiric-contracts/gen/go/sentiric/stt/v1;sttv1";

// SttWhisperService, Whisper motoruna özgü düşük seviyeli kontrat.
service SttWhisperService {
  // Bir ses dosyasının tamamını tek seferde metne çevirir.
  rpc WhisperTranscribe(WhisperTranscribeRequest) returns (WhisperTranscribeResponse);
  
  // Gerçek zamanlı bir ses akışını metne çevirir.
  rpc WhisperTranscribeStream(stream WhisperTranscribeStreamRequest) returns (stream WhisperTranscribeStreamResponse);
}

// Dosya tabanlı transkripsiyon için mesajlar
message WhisperTranscribeRequest {
  bytes audio_data = 1;
  optional string language = 2;
}

message WhisperTranscribeResponse {
  string transcription = 1;
  string language = 2;
  float language_probability = 3;
  double duration = 4;
  // ---- affective & speaker identity ----
  string gender_proxy = 5;
  string emotion_proxy = 6;
  float arousal = 7;
  float valence = 8;
  float pitch_mean = 9;
  float pitch_std = 10;
  float energy_mean = 11;
  float energy_std = 12;
  float spectral_centroid = 13;
  float zero_crossing_rate = 14;
  repeated float speaker_vec = 15; // 8-D vector
}

// Akış tabanlı transkripsiyon için mesajlar
message WhisperTranscribeStreamRequest {
  // Ses verisi 16kHz, 16-bit, mono, ham PCM formatında olmalıdır.
  bytes audio_chunk = 1;
}

message WhisperTranscribeStreamResponse {
  string transcription = 1;
  bool is_final = 2; // Bu segmentin nihai sonuç olup olmadığını belirtir.
  // ---- affective & speaker identity ----
  string gender_proxy = 3;
  string emotion_proxy = 4;
  float arousal = 5;
  float valence = 6;
  float pitch_mean = 7;
  float pitch_std = 8;
  float energy_mean = 9;
  float energy_std = 10;
  float spectral_centroid = 11;
  float zero_crossing_rate = 12;
  repeated float speaker_vec = 13;
}
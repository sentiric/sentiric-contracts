// ========== FILE: sentiric-contracts/proto/sentiric/dialplan/v1/dialplan.proto ==========
syntax = "proto3";

package sentiric.dialplan.v1;

import "sentiric/user/v1/user.proto";

option go_package = "github.com/sentiric/sentiric-contracts/gen/go/sentiric/dialplan/v1;dialplanv1";

service DialplanService {
  rpc ResolveDialplan(ResolveDialplanRequest) returns (ResolveDialplanResponse);
}

message ResolveDialplanRequest {
  string caller_contact_value = 1; // Artık bu bir telefon numarası (veya whatsapp id)
  string destination_number = 2;
}

message ActionData {
  map<string, string> data = 1;
}

message DialplanAction {
  string action = 1;
  ActionData action_data = 2;
}

message ResolveDialplanResponse {
  string dialplan_id = 1;
  string tenant_id = 2;
  DialplanAction action = 3;
  optional sentiric.user.v1.User matched_user = 4;
  // YENİ: Hangi contact üzerinden eşleştiğini de belirtiyoruz.
  optional sentiric.user.v1.Contact matched_contact = 5; 
}